{% extends 'base.html' %}
{% block content %}

<script src="https://cdn.tailwindcss.com"></script>

<style>
/* Gemini-derived styles (converted to plain CSS) */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

body {
    font-family: 'Inter', sans-serif;
}

.post-card {
    background-color: #1f2937; /* dark background for contrast */
    transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 1rem;
    overflow: hidden; /* ensures images and content stay within rounded corners */
}

.post-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
                0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

.prose {
    color: #D1D5DB;
}

.prose h1,
.prose h2,
.prose h3 {
    color: #F9FAFB;
}

.prose a {
    color: #A78BFA;
}

.prose blockquote {
    border-left: 4px solid #8B5CF6;
    padding-left: 1rem;
    color: #9CA3AF;
    margin: 1rem 0;
}

/* small helpers for the layout inside your block */
.detail-hero {
    border-radius: 0.5rem;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0,0,0,0.35);
}
.related-img {
    width: 96px;
    height: 96px;
    object-fit: cover;
    border-radius: 0.375rem;
}

</style>

<main class="container mx-auto px-6 py-8 flex-grow">
    <div class="flex flex-col lg:flex-row lg:gap-12">

        <!-- Main Post Content -->
        <article class="w-full lg:w-2/3">
            <!-- Post Header -->
            <header class="mb-8">
                {% if post.category %}
                    <p class="text-purple-400 font-semibold">{{post.category.name |upper }}</p>
                {% endif %}
                <h1 class="text-4xl md:text-5xl font-extrabold text-white tracking-tight my-4">
                    {{ post.title }}
                </h1>
                <div class="flex items-center text-gray-400">
                    <img class="w-10 h-10 rounded-full mr-4"
                         src="{{ post.author_avatar_url|default:'https://placehold.co/100x100/1F2937/FFFFFF?text=A' }}"
                         alt="{{ post.author|default:'Author' }}">
                    <div>
                        <p class="font-medium text-gray-300">By {{ post.author|default:"Admin" }}</p>
                        <p class="text-sm">Posted on {{ post.date_posted|date:"F j, Y" }}</p>
                    </div>
                </div>
            </header>

            <!-- Hero Image -->
            {% if post.img_url %}
            <div class="detail-hero mb-8">
                <img class="w-full h-auto max-h-[600px] object-cover" src="{{ post.img_url }}" alt="{{ post.title }}">
            </div>
            {% endif %}

            <!-- Post Content -->
            <div class="prose prose-lg max-w-none text-gray-300 leading-relaxed">
                {{ post.content|safe }}
            </div>
        </article>

        <!-- Sidebar with Related Posts -->
        <aside class="w-full lg:w-1/3 mt-12 lg:mt-0">
            <div class="sticky top-8">
                <h2 class="text-3xl font-bold text-white mb-8 text-left">Related Posts</h2>

                <div class="flex flex-col gap-6">
                        {% if related_posts %}
                            {% for related in related_posts %}
                                <div class="post-card h-auto w-auto bg-gray-900 rounded-lg overflow-hidden shadow-lg flex items-center">
                                    <img class="related-img w-32 h-32 object-cover flex-shrink-0 mx-4 my-4"
                                        src="{{ related.img_url|default:'https://placehold.co/400x400/1F2937/FFFFFF?text=No+Image' }}"
                                        alt="{{ related.title }}">
                                    <div class="p-4">
                                        <h3 class="text-lg font-bold text-white mb-1">{{ related.title|truncatechars:50 }}</h3>
                                        <p class="text-gray-400 text-sm mb-2">{{ related.content|truncatechars:70 }}</p>
                                        <a href="{% url 'blog:detail' slug=related.slug %}" class="text-purple-400 hover:text-purple-300 font-semibold text-sm">
                                            Read More &rarr;
                                        </a>
                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <p class="text-gray-400">No related posts found.</p>
                        {% endif %}
                </div>
            </div>
        </aside>
    </div>
</main>
{% endblock %}
